[TOC]

# 基本概念

## 内容概述
* 语法
* 数据类型
* 流控制语句
* 函数

## 简述
* 任何语言的核心都必然会描述这门语言最基本的工作原理。而描述的内容通常都要涉及这门语言的语法、操作符、数据类型、内置功能等用于构建复杂解决方案的基本概念。ECMA-262通过叫做ECMAScript的‘伪语言’为我们描述了JavaScript的所有这些基本概念

## 语法
* ECMAScript的语法大量借鉴C及其他类C语言的语法。。

### 区分大小写
* 第一个概念就是ECMAScript中的一切变量(变量、函数名和操作符)都是区分大小写的.并且有的名称不能用于标识符，因为他们是关键字

### 标识符
* 所谓标识符，就是指变量、函数、属性的名字，或者函数的参数。标识符可以按照下列各式规则组合起来的一个或多个字符
    * 第一个字符必须是一个字母、下划线(_)、或一个美元符号($)
    * 其他字符可以是字母、下划线、美元符号或数字
    * 按照惯例，ECMAScript标识符采用驼峰大小写格式，就是第一个字母小写，剩下每个单词首字母大写

### 注释
* ECMAScript 使用C风格的注释，包括单行注释和块级注释。
    * // 单行注释
    * /* 块级注释 */

### 严格模式
* ECMAScript 5 引入严格模式的概念，为JavaScript定义了一种不同的解析与执行模型，ECMAScript 3 中的一些不确定行为将得到处理，某些不安全行为将会抛出错误。要在整个脚本中启用严格模式，可以在顶部添加如下代码 ： "use strict"
* 看起来像是字符串，但其实他是一个编译指示，用于告知JavaScript引擎切换到严格模式。
* 在函数的上方包含这条编译指示，可以指定函数在严格模式下执行。

### 语句
* ECMAScript中的语句以一个分号结尾；如果省略分号，则由解释器确定语句的结尾，虽然语句结尾的分号不是必须的，但是建议任何时候都不要省略他。这样可以删除多余的空格来压缩，另外加上分号有时候可以提升性能。
* 条件控制语句中，例如if,最好始终使用代码块。即便只有一条语句。

## 关键字和保留字
* 关键字
    * break, do, instanceof, typeof, case, else, new, var, catch, finally, return, void, continue, for, switch, while, debugger, function, this, with, default, if, throw, delete, in, try
* 保留字
    * abstract, enum, int, short, boolean, export, interface, static, byte, extends, long, super, char, final, native, synchronized, class, float, package, throws, const, goto, private, transient, debugger, implements, protected, volatile, double, import, public, let, yield

## 变量
* ECMAScript的变量是松散类型的，就是可以用来保存任何类型的数据。换句话说，每个变量仅仅是一个用于保存值的占位符而已。定义变量使用var关键字。
* `var message;` 这样就定义一个名为message的变量，可以用来保存任何值，未经过初始化的变量，会保存一个特殊值---undefined.
* 初始化语法 `var message = 'hi';`
* 初始化就是给变量赋一个值，因此以后修改变量值的同时能够修改值的类型
    ```
        var message = 'hi';
        message = 10;
    ```
    * 但不推荐，尽量不要修改变量的类型
* 使用var定义的变量将成为定义该变量作用域中的局部变量。(函数中定义的变量，出了函数作用域会被销毁)
* 如果直接使用一个没有声明过的变量那么会在当前作用域的最顶级定义一个全局变量，不要尝试这种做法

## 数据类型
* 简述
    * ECMAScript中有5种简单数据类型(也称为基本数据类型)：Undefined、Null、Boolean、Number、String 和 一种复杂数据类型 -- Object。
    * Object本质上是由一组无序的名值对组成的。ECMAScript不支持任何创建自定义类型的机制，所有的值最终都将是上述6中数据类型之一。由于、ECMAScript数据类型具有动态性，因此的确没有在定义其他数据类型的必要性了。

* typeof 操作符
    * 因为ECMAScript是松散类型的，所以需要有一种手段来检测给定变量的数据类型--typeof就是负责提供这方面信息的操作符，对一个值使用typeof操作符可能会返回下列某个字符串
        * "undefined" ---> 如果这个值未定义
        * "boolean" ---> 如果这个值时布尔值
        * "string" ---> 如果这个值时字符串
        * "number" ---> 如果这个值是数值
        * "object" ---> 如果这个值时数值
        * "function" ---> 如果这个值是函数
    * 有些时候，typeof操作符会返回一些令人迷惑但技术上却正确的值，从一些技术角度上讲，函数在ECMAScript中是对象，不是一种数据类型，然而，函数也确实有一些特殊的属性，因此通过typeof操作符来区分函数和其他对象是很有必要的。

* Undefined 类型
    * Undefined类型只有一个值，就是特殊的undefined.在使用var声明变量但未对其初始化时，这个变量的值就是undefined.
    * 比较未初始化变量与undefined 是相等的
    * 一般不存在显示的把一个变量设置为undefined值的情况。字面值的主要目的适用于比较，ECMA-262第三版之前没有规定这个值。引入他是为了区分空对象指针域未经初始化的变量.
    * 不过包含undefined值的变量与尚未定义的变量还是不一样的。 对于未经声明变量只能进行一项操作，就是使用typeof操作符检测其数据类型。(比较疑惑地是 对未经初始化的变量执行typeof操作符会返回undefined值，而对未声明的变量执行typeof操作符同样会返回undefined)，有逻辑上的合理性。因为两种变量从技术上看有本质区别，但无论对于那种变量也不能执行真正的操作
    * 即便未初始化的变量会自动被赋予undefined值，但显示的初始化变量依然是明智的选择，如果能够做到这一点，那么当typeof操作符返回"undefined"值时，我们就知道被检测的变量还没有被声明，而不是尚未初始化。

* Null 类型
    * Null类型是第二个只有一个值的数据类型，这个特殊的值是null.从逻辑角度，null值表时一个空对象指针，这正是使用typeof操作符检测null值时会返回'object'的原因。
    * 如果定义的变量准备在将来用于保存对象，那么最好将该变量初始化为null而不是其他值。这样一来，只要直接检查null值就可以知道相应的变量是否保存了一个对象的引用。
    * undefined值是派生自null值的，所以相等性测试要返回true。(null == undefined会返回true,因为这个操作符出于比较的目的会转换器操作数)
    * 注意，只要在保存对象的变量还没有真正的保存对象，那么就应该明确地让该变量保存null值。

* Boolean类型
    * Boolean类型是ECMAScript中使用最多的一种类型，该类型只有两个字面值，true和false. 虽然Boolean类型的字面值只有两个，但是ECMAScript中所有类型的值都有与这两个Boolean值等价的值。要将一个值转换为其对应的Boolean值，可以调用转型函数Boolean().
    * 其他数据类型对于boolean类型的转换。
        * String只要非空字符串都是真的。
        * Number除了0和NAN都是真的。
        * Object除了null都是真的。
        * undefined值都是假的

* Number类型
    * Number雷士应该是最令人关注的类型了，这种类型使用IEEE754格式来表示整数和浮点数。为了支持各种数值类型，定义了不同的数值字面量格式
    * 整数字面量
        * 十进制整数
            * var intNum = 55;
        * 八进制整数
            * var octalNum = 070;
        * 十六进制整数
            * var hexNum = 0xA;
    * 浮点数
        * 浮点数就是该数值中必须包含一个小数点，并且小数点后面必须至少有一位数字，由于浮点数值需要的内存空间是保存整数值的两倍，因此ECMAScript会不失时机的将浮点数转换为整数值。
            * `例如 var floatNum = 10.0   // 会被转换为10`
        * 对于极大值或者极小值，可以使用e表示法表示的浮点数值表示。e表示法表示的数值等于e前面的数值乘以10的指数次幂。
    * 数值范围
        * ECMAScript能够表示的最小数值保存在Number.MIN_VALUE中，能够保存的最大数值保存在Number.MAX_VALUE. 如果某次计算的结构得到了一个超出JavaScript数值范围的值，那么这个数值将会被自动转换为特殊的Infinity(有正负)。如果某次计算返回了正负的Infinity，那么该值将无法继续参加下一次运算。可以使用ifFinite() 判断一个数值是不是有限的。
    * NAN
        1. 0/0 会返回NaN，其他数除以零返回Infinity。
        2. 任何涉及NaN的操作都会返回NaN。
        3. 其次NaN与任何值都不相等。包括NaN本身。
            * 可以使用isNaN函数来判断参数是不是不是数值
    * 数值转换(将非数值类型转换为数值)
        * Number()函数----》 可用于任何类型
            * 如果是Boolean值，true和false将被转换为1和0
            * 如果是数字值，只是简单地传入传出
            * 如果是null，返回0
            * 如果是undefined,返回NaN
            * 如果是字符串，遵循以下规则
                * 如果只包含正常格式的数字(十进制，十六进制)而不包含任何其余字符。那么将会转换为数值。（不能解析八进制）（忽略空格）
                * 如果字符串是空的，转换为0
                * 如果包含其他格式字符，返回NaN
            * 如果是对象，首先调用对象的valueOf()方法，如果返回值是NaN，则调用对象的toString() 方法，在依次处理
            * ***注意一元+操作符和Number函数表现一致***
        * parseInt()   ---》  只处理字符串转换成数值
            * 忽略字符串前面的空格，直到找到第一个非空格字符。如果第一个字符不是数字或符号，parseInt()返回NaN.(所以转换空字符串返回NaN)
            * 如果第一个字符是数字字符，parseInt() 会继续解析。直到解析完成所有后续字符或者遇到了一个非数字字符，
                * parseInt('1234blue')  // 1234
            * 能够识别各种进制字面量
            * 可以为parseInt() 传递第二个参数，转换时使用的基数（进制）必要的
        * parseFloat() 
            * 也是从第一个字符开始解析，基本和parseInt() 一致。不过始终会忽略前导零。

* String类型
    * String类型用于表示由0或多个16进制unicode字符组成的字符序列。就是字符串。在ECMAScript中，单引号表示字符串和双引号表示字符串是完全相同的，(但是以双引号开头，必须以双引号结尾)
    1. 字符字面量
        * 转义字符
            * \\n  换行
            * \\t  制表
            * \\b  空格
            * \\r  回车
            * \\\\  斜杠
            * \\'   在单引号表示在字符串中使用 'He said, \\' hey.\''
            * \\"   在双引号表示的字符串中使用 "He said, \\"hey.\""
            * \\unnnn  以四位十六进制表示的unicode码点。
        * 注意，转义字符相当于是一个字符。
        * 可以通过字符串的length属性访问字符串长度。string.length
    2. 字符串的特点
        * ECMAScript中的字符串是不可改变的， 也就是说，字符串一旦别创建，他们的值就不能被改变。要改变某个变量中保存的字符串，首先要销毁原来的字符串。然后创建一个新的。
        ```
            var lang = 'Java';
            lang = lang + 'Script';
        ```
        * javascirp的做法是，lang开始时包含字符串'Java'.而第二行代码把lang的值重新定义为'JavaScript',做法为，首先创建一个能够容纳10个字符的新字符串，然后在这个字符串中填充'Java' 和 'Script',最后一步是销毁原来的字符串"Java"和"Script"
    3. 转换字符串的方法
        1. 对象toString方法
            * 除了null和undefined值没有这个方法其余类型都有这个方法
            * 在数值类型调用时，可以传递一个值，来表示获取的字符串的进制表示
        2. String()函数
            * 可以将任意类型转换为字符串类型
            * 如果有toString方法，调用toString方法
            * null返回 'null'   undefined 返回 'undefined'

* Object类型
    * ECMAScript中的对象其实就是一组数据和功能的集合。对象可以通过执行new操作符后跟要创建的对象类型的名称来创建。创建Object类型的实例并为其添加属性或方法，就可以创建自定义对象。
    * var o = new Object();  如果不给构造函数传递参数，完全可以省略。不推荐，并且Object是ECMAScript中一切对象的基础，Object中具有的方法同样存在于更具体的对象中。
    * Object方法简介
        1. constructor
            * 保存着用于创建当前对象的函数，对于前面的例子，构造函数就是Object()
        2. hasOwnProperty(propertyName)
            * 用于检查给定的属性在当前对象实例(而不是在原型中)中是否存在，参数的属性名必须以字符串形式指定
        3. isPrototypeOf(object)
            * 用于检查传入的对象是否是传入对象的原型
        4. propertyIsEnumerable()
            * 用于检查给定的属性是否能够使用for-in语句来枚举，必须以字符串传递
        5. toLocaleString()
            * 返回对象的字符串表示，该字符串与执行环境的地区对应
        6. toString() 
            * 返回对象的字符串表示
        7. valueOf()
            * 返回对象的字符串表示、数值或者布尔值，通常与toString返回值相同
    * 其实从宿主角度上来说，ECMA-262中对象的行为不一定会适用于JavaScript中的其他对象。浏览器环境中的对象，比如BOM和DOM中的对象，都属于宿主对象，因为他们是由宿主实现提供和定义的。ECMA-262不负责宿主对象，所以宿主对象可能不会继承Object

## 操作符
* 简述
    * ECMA-262 描述了一组用于操作数据值的操作符，包括算数操作符(如加号和减号)、位运算符、关系操作符和相等操作符，在JavaScript中他们都能够适用于很多值，例如字符串，数字，布尔值，甚至是对象。不过应用于对象时，相应的操作符通常都会调用对象的valueOf() 或 toString()

### 一元操作符
* 只能操作一个值的操作符叫做一元操作符。一元操作符是ECMAScript中最简单的操作符。
1. 递增递减操作符
    * 借鉴与c语言，有两个版本，前置型和后置型。
    * 对于任何的类型都适合
        * 在应用于一个包含有效数字字符的字符串时，先将其转换为数字值，在执行加1的操作
        * 在应用于一个不包含有效数字字符的字符串时，将变量的值设置NaN.
        * 在应用布尔值时，false先转换为0,true转换为1
        * 应用于对象时，先调用对象的valueOf方法取得一个可供操作的值，如果为NaN,调用对象的toString方法

2. 一元加和减操作符
    * + 操作符的作用和数学书上讲的完全一样。一元加操作符以一个加号表示，放在数值前面，对于数值不会有任何影响
    * 不过对于非数值，该操作符会像Number转型函数一样对这个值执行转换。
    * 一元减基本规则相同

### 位运算符
* 用于最基本的层次上，按内存中表示数值的位来操作数值。
* ECMAScript，当对于数值应用位操作符时，会进行如下的转换，64位数值会被转换为32位，然后执行未操作，最后再将32位结果转换会64位数值，看起来就和操作32位数值一样，但是转换过程有一个很严重的问题，就是NaN和Infinity应用位运算都会被当做0来处理。
* 对于非数值类型，会先使用Number()函数将该值转换为一个数值。
* 位运算符
    * 按位非(NOT)
        * ~
    * 按位与(AND)
        * &
    * 按位或(OR)
        * |
    * 按位异或(XOR)
        * ^
    * 左移
        * <<
    * 有符号右移
        * >>
    * 无符号右移
        * >>>

### 布尔操作符
1. 逻辑非
* 由一个叹号表示，可以用于ECMAScript中的任何值，无论是什么类型，都会返回一个boolean类型。  相当于先调用Boolean函数，然后取反。
* 使用两个!!号 相当于Boolean()函数

2. 逻辑与操作 &&
    1. 全真则真，有假则假
    2. 短路操作，与就是想丢出来一个假

3. 逻辑或  ||
    1. 全假则假，有真则真
    2. 短路操作，或就是想丢出来一个真的

### 乘性操作符
* 也是一样的，当操作数为非数值的情况下会执行自动的类型转换。后台会先使用Number函数转换为数值，然后在运算。

1. 乘法  *
    1. 如果乘积超过表示的范围，那么会返回Infinity
    2. 有一个操作数时NaN，那么结果为NaN
    3. Infinity与0相乘，结果为NaN
    4. 如果Infinity与非0数值相乘，那么为正负Infinity（与数值符号有关）
    5. 如果是Infinity与Infinity相乘，则结果是Infinity

2. 除法
    1. 如果商超过表示，那么返回Infinity或-Infinity
    2. 如果一个数是NaN，那么结果为NaN
    3. 如果Infinity被Infinity除，那么结果是NaN
    4. 0被0除，结果是NaN
    5. 如果非零的数被零除，则结果是Infinity或-Infinity。
    6. 如果Infinity被任何非零数值除，则结果为Infinity

3. 求模
    1. 如果被除数都是无穷大值而除数是有限大的数值，则结果是NaN
    2. 如果被除数是有限大数值而除数是零，则结构是NaN
    3. Infinity被Infinity除结果是NaN
    4. 如果被除数有限大，初始无限的，那么结果是被除数
    5. 被除数是零，结果是0

### 加性操作符  
* + 
    * 加法操作符的后台很复杂。
    * 加法操作
        1. 如果有一个为NaN那么结果为NaN
        2. 如果是Infinity加Infinity结果为Infinity（负的也一样）
        3. 如果是Infinity-Infinity结果为NaN
        4. 如果有一个操作数是字符串，呢么就要应用以下规则
            * 如果两个操作数都是字符串，直接连接起来
            * 如果只有一个操作数时字符串，则将另外一个操作数转换为字符串，然后连接，调用String()

* -
    1. 特殊的基本一样
    2. 如果有一个操作数是字符串、布尔、null、undefined,则调用Number函数将其转换为数值，然后依据减法规范计算如果转换结果是NaN，则减法结果就是NaN
    3. 如果一个操作数时对象，那么调用对象的valueOf(), 如果是NaN，结果就是NaN，如果没有valueOf()  那么调用toString().

### 关系操作符
* 小于<、大于>、小于等于<=和大于等于>=这几个关系操作符用于对两个值进行比较，比较的规则我们数学课上学的一样。都返回一个boolean值
* 如果两个操作数都是数值进行数值的比较。
* 如果两个操作数都是字符串，则比较两个字符串对应的字符编码值。
* 如果一个操作数是数值，则将连一个操作数转换为一个数值
* 如果操作数是对象，那么调用valueOf() 方法，如果没有调用toString()
* 如果一个操作数时布尔，将其转换为数值。
* 设计NaN的运算都是false

### 相等操作符
* 确定两个变量是否相等是一个非常重要的操作，在比较字符串、数值、布尔值的相等性时，问题还比较简单。但涉及到对象就比较负责
* ECMAScript有两种比较方案，1.相等和不相等 2. 全等和不全等
    1. 相等和不相等
        * 注意这两个操作符都会先转换操作数，然后在比较他们的相等性。
        * 规则
            1. 如果有一个操作是布尔值，则在比较相等性之前先将其转换为数值
            2. 如果一个操作数是字符串，另一个操作数是数值，比较之前字符串转换为数值
            3. 如果一个操作数是对象，另一个不是，则调用valueOf方法。
            4. null和undefined是相等的，并且比较之时不能将null和UNdefine的转换成任何值
            5. 如果两个操作数都是对象，则比较他们是不是同一个对象。
    2. 全等不不全等
        * 比较之前不转换值的类型

### 条件运算符
* variable = boolean ? true : false;

### 赋值操作符
1. var num = 10;

* *=
* /=
* ...

### 逗号操作符
* 使用逗号操作符可以在一条语句中执行多个操作。

## 语句

### if语句
* if(condition) statement1 else statement2

### do while语句
* do{ statement } while(expression);

### while 语句
* while(expression) statement

### for语句
* for(initialization; expreeesion; post-loop-expression) statement

### for - in 语句
* 用于迭代对象
```
    for(var propName in window){
        document.write(propName)
    }
```

### label语句
label:statement
* 将来可以用于break和continue语句中

### break和 continue语句这些跳过

### with语句
* with语句的作用是将代码的作用域设置到一个特定的对象中。
* 语法 `with (expression) statement;`
* 用途
    * 为了简化多次编写同一个对象的工作
    ```
        例如 
        var qs  = location.search.substring(1);
        var hostName = location.hostname;
        var url = lcation.href;

        with(location){
            var qs = search.substring(1);
            var hostName = hostname;
            var url = href;
        }
    ```
### switch 语句
* 语法
```
switch(expression){
    case value: statement
    break;
}
```
* 注意 switch比较使用的是全等操作符

## 函数
* 函数对于任何一个语言都是核心的概念，通过函数可以封装多条语句，可以在任何地方执行和调用，ECMAScript中的函数使用function声明来实现。
* 语法
```
    function func(){
        alert('hello world')
    }
```
* 不需要指定是否返回值，任何函数在任何时候都可以返回值。
* 要么让函数始终返回一个值，要么永远不要返回。
* 严格模式下，不能把函数或参数命名为eval或arguments
* 理解参数
    * ECMAScript函数的参数与大多数其他语言中的参数有所不同，ECMAScript不介意传入多少个参数，也不介意是什么类型，即使你定义的函数只接受两个参数，在调用这个函数的时候也不一定非要传递两个参数，可以传递一个两个甚至不传递。解释器永远不会有怨言。 ***原因是 js中的参数在内部是使用一个数组来表示的，函数接收的永远都是这个数组，不关心数组中包含哪些参数。 可以通过arguments对象访问这个参数数组***
    * js的命名参数只是提供便利，不一定必须。
* 没有重载
    * 在js中参数由数组表示，不可能实现真正的重载。
    * 如果在js中定义了两个名字相同的函数，则该名字只属于后定义的函数。